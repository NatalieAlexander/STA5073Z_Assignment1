"0",""
"0","#Grid search"
"0","max_depth_grid =c(1, 2, 3, 4, 5, 6) #up to default value = 6"
"0","eta_grid = c(0.2, 0.4, 0.6, 1) #ranges from 0 to 1"
"0","gamma_grid = c(0.5, 1)"
"0",""
"0",""
"0","#empty data frame to store results for each combination of parameters above"
"0","results <<- data.frame(max_depth = integer(),"
"0","                       eta = double(),"
"0","                       gamma = double(),"
"0","                      train_accuracy = double(), valid_accuracy = double(),"
"0","                      train_recall = double(), valid_recall = double(),"
"0","                      train_ppv = double(), valid_ppv = double(),"
"0","                      train_f1 = double(), valid_f1 = double())"
"0",""
"0","#number of folds"
"0","num_folds <- 5"
"0",""
"0","#create folds"
"0","set.seed(123)"
"0","folds <- createFolds(df_train$president_label, k = num_folds, list = TRUE)"
"0",""
"0","###########################################"
"0",""
"0","#for each parameter combination..."
"0","for (md in max_depth_grid) {"
"0","  for (e in eta_grid) {"
"0","    for (g in gamma_grid) {"
"0",""
"0","      #empty vectors for results at each fold..."
"0","      train_accuracy_values <- numeric(num_folds)"
"0","      valid_accuracy_values <- numeric(num_folds)"
"0",""
"0","      train_recall_values <- numeric(num_folds)"
"0","      valid_recall_values <- numeric(num_folds)"
"0",""
"0","      train_ppv_values <- numeric(num_folds)"
"0","      valid_ppv_values <- numeric(num_folds)"
"0",""
"0","      train_f1_values <- numeric(num_folds)"
"0","      valid_f1_values <- numeric(num_folds)"
"0",""
"0",""
"0","################################################"
"0",""
"0","      #for each fold..."
"0","      for (fold in 1:num_folds) {"
"0",""
"0",""
"0","        #split data into k-fold train and validation sets"
"0","        train_indices <- unlist(folds[-fold]) #all folds except 1 fold"
"0","        valid_indices <- unlist(folds[fold]) #only 1 fold"
"0","        "
"0","        df_train_fold <- df_train[train_indices, ]"
"0","        df_valid_fold <- df_train[valid_indices, ]"
"0",""
"0","        #get train label data"
"0","        president_labels = df_train_fold$president_label"
"0","        train_fold_label = as.integer(df_train_fold$president_label)-1 #xgboost: numeric data & classes start at 0"
"0","        df_train_fold$president_label = NULL #remove label data"
"0",""
"0","        #get validation label data"
"0","        president_labels = df_valid_fold$president_label"
"0","        valid_fold_label = as.integer(df_valid_fold$president_label)-1 #xgboost: numeric data & classes start at 0"
"0","        df_valid_fold$president_label = NULL #remove label data"
"0",""
"0","        #convert dataframes to appropriate inputs for xgboost"
"0","        ##validation"
"0","        df_valid_fold_xgb = xgb.DMatrix(as.matrix(sapply(df_valid_fold,"
"0","                                                         as.numeric)),"
"0","                                        label = valid_fold_label,"
"0","                                        nthread = 2)"
"0","        ##train"
"0","        df_train_fold_xgb = xgb.DMatrix(as.matrix(sapply(df_train_fold,"
"0","                                                         as.numeric)),"
"0","                                        label = train_fold_label,"
"0","                                        nthread = 2)"
"0",""
"0",""
"0",""
"0","        ###########################################"
"0","        "
"0","        #fit the model with parameters at the current iteration"
"0","        set.seed(123)"
"0","        xgb_fit <- xgboost(data=df_train_fold_xgb,"
"0","                           label=train_fold_label,"
"0","                           max_depth = md, eta = e, gamma= g, lambda = 1,"
"0","                           nthread = 2, nrounds = 2,"
"0","                           params=list(objective = ""multi:softmax"","
"0","                                       num_class=4))"
"0",""
"0","       ###########################################"
"0",""
"0","        # Predict on train data"
"0","        set.seed(123)"
"0","        fittedtrain <- predict(xgb_fit, df_train_fold_xgb, type = 'class')"
"0",""
"0","        #convert numeric fitted values in train data to factors"
"0","        fittedtrain = levels(as.factor(df_train$president_label))[fittedtrain+1] #offset by +1 because xgboost starts class at 0"
"0",""
"0","        #convert numeric fitted values in reference data to factors"
"0","        ##use df_train factors which is gauranteed to include all classes"
"0","        ref = levels(as.factor(df_train$president_label))[train_fold_label+1] #offset by +1 because xgboost starts class at 0"
"0",""
"0","        # train confusion matrix"
"0","        train_conf_mat <- confusionMatrix(data=factor(fittedtrain,"
"0","                                                         levels=c(""Mandela"","
"0","                                                                  ""Mbeki"","
"0","                                                                  ""Ramaphosa"","
"0","                                                                  ""Zuma"")),"
"0","                                          reference=factor(ref,"
"0","                                                         levels=c(""Mandela"","
"0","                                                                  ""Mbeki"","
"0","                                                                  ""Ramaphosa"","
"0","                                                                  ""Zuma"")),"
"0","                                          mode = ""everything"")"
"0",""
"0","        #ensure Nan and NA values are 0"
"0","        train_conf_mat$byClass[is.na(train_conf_mat$byClass)] <- 0"
"0","        train_conf_mat$byClass[is.nan(train_conf_mat$byClass)] <- 0"
"0",""
"0","        # Compute the average train accuracy"
"0","        train_accuracy_values[fold] <- round(train_conf_mat$overall['Accuracy'], 3)"
"0",""
"0","        # Compute the average train recall"
"0","        train_recall_values[fold] <- round(mean(train_conf_mat$byClass[,'Sensitivity']), 3)"
"0",""
"0","        # Compute the average train positive predictive value or ""precision"""
"0","        train_ppv_values[fold] <- round(mean(train_conf_mat$byClass[,'Pos Pred Value']), 3)"
"0",""
"0","        # Compute the average train F1-score"
"0","        train_f1_values[fold] <- round(mean(train_conf_mat$byClass[,'F1']), 3)"
"0",""
"0",""
"0","        ###########################################"
"0",""
"0","        # Predict on validation data"
"0","        set.seed(123)"
"0","        fittedvalid <- predict(xgb_fit, df_valid_fold_xgb, type = 'class')"
"0",""
"0","        #convert numeric fitted values in valid data to factors"
"0","        ##use df_train factors which is gauranteed to include all classes"
"0","        fittedvalid = levels(as.factor(df_train$president_label))[fittedvalid+1] #offset by +1 because xgboost starts class at 0"
"0",""
"0","        #convert numeric fitted values in reference data to factors"
"0","        ##use df_train factors which is gauranteed to include all classes"
"0","        ref = levels(as.factor(df_train$president_label))[valid_fold_label+1] #offset by 1 because xgboost starts class at 0"
"0",""
"0","        # validation confusion matrix"
"0","        valid_conf_mat <- confusionMatrix(data=factor(fittedvalid,"
"0","                                                         levels=c(""Mandela"","
"0","                                                                  ""Mbeki"","
"0","                                                                  ""Ramaphosa"","
"0","                                                                  ""Zuma"")),"
"0","                                          reference=factor(ref,"
"0","                                                         levels=c(""Mandela"","
"0","                                                                  ""Mbeki"","
"0","                                                                  ""Ramaphosa"","
"0","                                                                  ""Zuma"")),"
"0","                                          mode = ""everything"")"
"0",""
"0","        #ensure Nan and NA values are 0"
"0","        valid_conf_mat$byClass[is.na(valid_conf_mat$byClass)] <- 0"
"0","        valid_conf_mat$byClass[is.nan(valid_conf_mat$byClass)] <- 0"
"0",""
"0","        # Compute the average validation accuracy"
"0","        valid_accuracy_values[fold] <- round(valid_conf_mat$overall['Accuracy'], 3)"
"0",""
"0","        # Compute the average validation recall"
"0","        valid_recall_values[fold] <- round(mean(valid_conf_mat$byClass[,'Sensitivity']), 3)"
"0",""
"0","        # Compute the average validation positive predictive value or ""precision"""
"0","        valid_ppv_values[fold] <- round(mean(valid_conf_mat$byClass[,'Pos Pred Value']), 3)"
"0",""
"0","        # Compute average validation F1-score"
"0","        valid_f1_values[fold] <- round(mean(valid_conf_mat$byClass[,'F1']), 3)"
"0",""
"0","      }"
"0","      ###########################################"
"0",""
"0","      # Calculate the mean results across all folds"
"0","      "
"0","      ##accuracy"
"0","      mean_train_accuracy <- mean(train_accuracy_values) #train"
"0","      mean_valid_accuracy <- mean(valid_accuracy_values) #validation"
"0","      "
"0","      ##recall"
"0","      mean_train_recall <- mean(train_recall_values) #train"
"0","      mean_valid_recall <- mean(valid_recall_values) #validation"
"0",""
"0","      ##PPV"
"0","      mean_train_ppv <- mean(train_ppv_values) #train"
"0","      mean_valid_ppv <- mean(valid_ppv_values) #validation"
"0",""
"0","      ##F1-Score"
"0","      mean_train_f1 <- mean(train_f1_values) #train"
"0","      mean_valid_f1 <- mean(valid_f1_values) #validation"
"0","      "
"0",""
"0","      ###########################################"
"0",""
"0","      # Store the results"
"0","      results <- rbind(results, data.frame(max_depth = md,"
"0","                       eta = e,"
"0","                       gamma = g,"
"0","                       train_accuracy = mean_train_accuracy,"
"0","                       valid_accuracy = mean_valid_accuracy,"
"0","                       train_recall = mean_train_recall, valid_recall = mean_valid_recall,"
"0","                       train_ppv = mean_train_ppv, valid_ppv = mean_valid_ppv,"
"0","                       train_f1 = mean_train_f1, valid_f1 = mean_valid_f1))"
"0","    }"
"0","  }"
"0","}"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.368489"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.352772"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.369269"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.355032"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.367308"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.351064"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.362713"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.343629"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.365507"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.348089"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.368489"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.352772"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.369269"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.355032"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.367308"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.351064"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.362713"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.343629"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.365507"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.348089"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.352132"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.323838"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.353664"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.327884"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.349884"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.319129"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.341223"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.309396"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.346556"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.316302"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.352132"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.323838"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.353664"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.327884"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.349884"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.319129"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.341223"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.309396"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.346556"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.316302"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.337320"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.297539"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.339605"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.302205"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.334166"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.289878"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.322022"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.280645"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.329607"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.289703"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.337320"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.297539"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.339605"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.302205"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.334166"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.289878"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.322022"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.280645"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.329607"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.289703"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.312564"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.252296"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.316437"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.258036"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.308182"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.241294"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.290850"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.231398"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.302100"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.240630"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.312564"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.252296"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.316437"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.258036"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.308182"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.241294"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.290850"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.231398"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.302100"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.240630"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.352651"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.323602"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.354441"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.326679"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.349967"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.319676"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.347848"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.316138"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.349987"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.319953"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.352651"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.324163"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.354441"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.326679"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.349967"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.319676"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.347848"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.316138"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.349987"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.319953"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.321816"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.268377"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.325246"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.278086"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.316703"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.267728"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.312652"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.262503"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.316749"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.268198"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.321816"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.268377"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.325246"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.278086"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.316703"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.267728"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.312652"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.262503"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.316749"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.268198"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.294000"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.227558"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.298917"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.235577"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.286771"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.223139"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.280981"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.219143"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.286847"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.224089"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.294000"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.227558"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.298917"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.235577"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.286771"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.223139"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.280981"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.219143"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.286847"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.224089"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.247943"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.158894"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.255347"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.163587"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.237509"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.131700"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.228732"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.151780"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.237647"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.150645"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.247943"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.158894"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.255347"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.163587"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.237509"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.131700"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.228732"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.151780"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.237647"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.150645"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.338427"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.298289"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.340629"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.302669"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.336472"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.295975"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.336377"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.295630"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.337014"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.296818"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.338427"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.298865"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.340629"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.302669"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.336472"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.295975"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.337043"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.296260"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.337014"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.296818"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.294724"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.227535"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.298834"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.228652"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.290827"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.216391"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.291003"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.225311"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.292059"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.218833"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.294724"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.227535"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.298834"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.228652"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.290827"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.216391"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.292194"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.226329"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.292059"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.218833"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.255471"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.170752"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.261173"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.170940"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.249730"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.155099"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.250543"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.171308"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.251762"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.162374"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.255471"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.170752"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.261173"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.170940"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.249730"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.155099"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.252075"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.171805"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.251762"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.162374"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.190912"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.084146"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.198797"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.086840"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.182006"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.054758"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.184965"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.088172"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.185769"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.079931"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.190912"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.084146"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.198797"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.086840"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.182006"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.054758"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.186514"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.088585"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.185769"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.083739"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.327404"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.279161"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.330733"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.285667"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.324883"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.270235"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.326296"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.278208"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.327166"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.279958"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.327404"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.280562"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.330733"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.285667"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.324883"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.270235"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.326962"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.278839"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.327166"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.280878"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.273698"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.195081"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.279925"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.200297"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.268780"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.181538"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.271792"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.197576"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.273166"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.191553"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.273698"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.196889"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.279925"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.201844"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.268780"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.181538"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.272985"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.198591"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.273166"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.193009"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.225550"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.130349"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.234210"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.137748"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.218456"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.113706"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.223207"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.137802"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.224693"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.126024"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.225550"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.130349"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.234210"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.140094"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.218456"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.113706"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.224739"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.138929"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.224693"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.126024"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.146714"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.039453"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.158778"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.046648"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.136184"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.005478"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.144476"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.049279"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.145095"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.039940"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.146714"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.058190"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.158778"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.046648"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.136184"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.008730"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.146019"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.053737"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.145095"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.042807"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.320160"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.266865"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.321608"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.269686"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.314929"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.257903"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.318037"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.264431"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.320834"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.268401"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.321728"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.270293"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.322479"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.271313"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.314929"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.258758"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.319589"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.267506"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.322213"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.271844"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.259872"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.175147"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.262603"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.182734"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.249726"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.158899"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.256070"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.175356"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.261120"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.181558"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.262863"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.180244"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.264242"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.187232"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.249726"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.160342"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.258938"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.180574"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.263688"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.187377"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.205836"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.106584"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.209663"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.118233"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.191184"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.079796"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.200887"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.110904"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.207510"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.110216"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.210099"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.114883"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.211960"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.127667"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.191184"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.081541"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.204770"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.117389"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.211081"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.118793"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.117331"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.014831"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.122752"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.016838"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.095105"
"1"," "
"1","
"
"1","[2]	train-mlogloss:0.967775"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.111698"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.011500"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.119129"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.021906"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.123694"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.032879"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.126030"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.031203"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.095105"
"1"," "
"1","
"
"1","[2]	train-mlogloss:0.971760"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.116549"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.025692"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.124242"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.033909"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.314922"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.257434"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.309580"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.248873"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.302433"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.235858"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.313440"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.256194"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.308728"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.245932"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.317130"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.264580"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.309580"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.250430"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.303095"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.237950"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.315697"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.262187"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.309216"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.246862"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.250158"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.160204"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.240074"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.149436"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.226353"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.127391"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.247347"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.160961"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.238760"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.145985"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.254293"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.170390"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.240074"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.155293"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.227546"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.130899"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.251524"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.170603"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.239618"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.154655"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.192445"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.088942"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.178325"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.078708"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.158695"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.051692"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.188523"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.084587"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.176948"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.076236"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.198219"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.099402"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.178325"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.093752"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.160296"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.056137"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.194224"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.096990"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.178045"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.085493"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.098999"
"1"," "
"1","
"
"1","[2]	train-mlogloss:0.994117"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.079084"
"1"," "
"1","
"
"1","[2]	train-mlogloss:0.987698"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.049756"
"1"," "
"1","
"
"1","[2]	train-mlogloss:0.935979"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.093475"
"1"," "
"1","
"
"1","[2]	train-mlogloss:0.981727"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.078520"
"1"," "
"1","
"
"1","[2]	train-mlogloss:0.981998"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.107235"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.018518"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.079084"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.020186"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.051891"
"1"," "
"1","
"
"1","[2]	train-mlogloss:0.949806"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.100944"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.012118"
"1"," "
"1","
"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.079752"
"1"," "
"1","
"
"1","[2]	train-mlogloss:1.002155"
"1"," "
"1","
"
"0","################################################################################"
"0",""
"0","#rename models"
"0","rownames(results) = paste0(""BoW XGB model "", 1:nrow(results))"
"0",""
"0","#check for optimal model with best train and validation f1-scores"
"0","best_results = results %>% filter(train_f1 > 0.4 & valid_f1> 0.4) %>% select(max_depth, eta, gamma, train_f1, valid_f1, "
"0","                                                                             train_accuracy, valid_accuracy,"
"0","                                                                             train_recall, valid_recall,"
"0","                                                                             train_ppv, valid_ppv)%>%"
"0","                                                        arrange(desc(train_f1),"
"0","                                                                desc(valid_f1))"
"0",""
"0","################################################################################"
"0","#re-fit the model on entire train set"
"0",""
"0","#get train label data"
"0","president_labels = df_train$president_label"
"0","train_label = as.integer(df_train$president_label)-1 #convert to numeric and offset by -1 because xgboost starts classes at 0"
"0",""
"0",""
"0","#convert dataframes to appropriate inputs for xgboost"
"0","df_train_xgb = xgb.DMatrix(as.matrix(sapply(df_train[, -c(150)], #remove label column"
"0","                                               as.numeric)),"
"0","                              label = train_label,"
"0","                              nthread = 2)"
"0",""
"0","#fit model to full train dataset"
"0","set.seed(123)"
"0","xgb_fit <- xgboost(data=df_train_xgb,"
"0","                 label=train_label,"
"0","                 max_depth = 6, eta = 1, gamma= 0.5, lambda = 1,"
"0","                 nthread = 2, nrounds = 2,"
"0","                 params=list(objective = ""multi:softmax"","
"0","                             num_class=4))"
"2","Warning: xgboost: label will be ignored."
"1","[1]	train-mlogloss:1.087616"
"1"," "
"1","
"
"1","[2]	train-mlogloss:0.972292"
"1"," "
"1","
"
"0","# ###############################################################################"
"0","#predictions on test set"
"0",""
"0","##get test label data"
"0","president_labels = df_test$president_label"
"0","test_label = as.integer(df_test$president_label)-1 #convert to numeric and offset by -1 because xgboost starts classes at 0"
"0",""
"0","#true test labels"
"0","test_labels = df_test$president_label"
"0","test_label = as.integer(as.factor(df_test$president_label))-1"
"0",""
"0","##convert dataframes to appropriate inputs for xgboost"
"0","df_test_xgb = xgb.DMatrix(as.matrix(sapply(df_test[, -c(150)], #remove label column"
"0","                                               as.numeric)),"
"0","                              label = test_label,"
"0","                              nthread = 2)"
"0",""
"0","#make predictions on test data"
"0","set.seed(123)"
"0","fittedtest <- predict(xgb_fit, df_test_xgb, type = 'class')"
"0",""
"0",""
"0","#convert numeric fitted values in test data to factors"
"0","fittedtest = levels(as.factor(df_train$president_label))[fittedtest+1] #offset by "
"0",""
"0","#convert numeric reference values in reference data to factors"
"0","ref = levels(as.factor(df_train$president_label))[test_label+1] #offset by 1 "
"0",""
"0","# validation confusion matrix"
"0","test_conf_mat <- confusionMatrix(data=factor(fittedtest,"
"0","                                                 levels=c(""Mandela"","
"0","                                                          ""Mbeki"","
"0","                                                          ""Ramaphosa"","
"0","                                                          ""Zuma"")),"
"0","                                  reference=factor(ref,"
"0","                                                 levels=c(""Mandela"","
"0","                                                          ""Mbeki"","
"0","                                                          ""Ramaphosa"","
"0","                                                          ""Zuma"")),"
"0","                                  mode = ""everything"")"
"0",""
"0",""
"0","#ensure Nan and NA values are 0"
"0","test_conf_mat$byClass[is.na(test_conf_mat$byClass)] <- 0"
"0","test_conf_mat$byClass[is.nan(test_conf_mat$byClass)] <- 0"
"0",""
"0","# Compute the test accuracy"
"0","all_results[3, ""test_accuracy""] <- round(test_conf_mat$overall['Accuracy'], 3)"
"0",""
"0","# Compute the test recall"
"0","all_results[3, ""test_recall""] <- round(mean(test_conf_mat$byClass[,'Sensitivity']), 3)"
"0",""
"0","# Compute the test positive predictive value or ""precision"""
"0","# Compute the test positive predictive value or ""precision"""
"0","all_results[3, ""test_ppv""] <- round(mean(test_conf_mat$byClass[,'Pos Pred Value']), 3)"
"0",""
"0","# Compute the test F1-score"
"0","all_results[3, ""test_f1""] <- round(mean(test_conf_mat$byClass[,'F1']), 3)"
"0",""
"0","#model ID of best sub model"
"0","#all_results[3, ""model_ID""] = rownames(best_results)[1]"
"0",""
"0","#parameters of best sub model"
"0","#all_results[3, ""parameters""] = rownames(best_results)[1]"
"0",""
